# Infographic Generator Skill

## 概要

このClaude Skillは、与えられた入力から読者が最も理解しやすい「単一HTML」インフォグラフィックを自動生成します。

## 特徴

- **動的プロンプト読み込み**: 実行時に`forGPT5`ブランチから最新のプロンプト仕様を読み込むため、プロンプトの更新が自動的に反映されます
- **精緻な実行計画**: プロンプトの指示を詳細に解析し、工程A（フラット化）→工程B（論理再構築）→工程C（視覚合成）の流れで処理を実行
- **品質保証**: 11項目の自動自己検査により、出力の品質を保証
- **完全自己完結型HTML**: 外部依存なし、CDN不使用、レスポンシブ対応の単一HTMLファイルを生成

## 使用方法

### 基本的な使い方

```bash
# Claude Codeでスキルを呼び出す
/infographic
```

スキルが起動すると、インフォグラフィック化したい情報の入力を求められます。

### 入力形式

以下のいずれかの方法で情報を提供できます：

1. **直接テキスト入力**
   ```
   製品Aは2020年に発売され、売上は年々増加している。
   2020年: 100万円、2021年: 250万円、2022年: 400万円
   ```

2. **ファイルパス指定**
   ```
   /path/to/data.txt
   ```

3. **短い抜粋を許可する場合**
   ```
   [ALLOW_SHORT_EXCERPTS]
   （情報を記述）
   ```

## プロンプト仕様

このスキルは`forGPT5`ブランチの`infographic/infographic_forCLI.md`に定義されたプロンプト仕様に従って動作します。

プロンプト仕様には以下が含まれます：
- 出力契約（単一HTML、外部依存なし等）
- QA要素排除ルール
- 引用・転載ポリシー
- 欠落ゼロの原則
- 反復フレーム
- 工程A/B/Cの詳細
- 自動自己検査項目

## 出力

完成したHTMLインフォグラフィックは以下の特徴を持ちます：

- ✅ 単一HTMLファイル（`<!DOCTYPE html>`から`</html>`まで）
- ✅ 外部依存なし（CDN、外部画像、Webフォント不使用）
- ✅ JavaScript不使用（セキュア）
- ✅ レスポンシブ対応（320px幅から対応）
- ✅ アクセシビリティ対応（コントラスト比4.5:1以上、キーボード操作可能）
- ✅ 印刷対応（モノクロでも判読可能）
- ✅ 実行計画書を`<head>`内に埋め込み（非表示）

## 処理工程

### 工程A: フラット化と要素化
入力情報を要素化し、ID（E001...）を付与して管理。社会的文脈を判定し、欠落を最小化。

### 工程B: 論理再構築
3系統以上の構造候補を生成し、適応度評価により最適な構造を選択。

### 工程C: 視覚合成
3-5系統のデザイン案を生成し、交叉・変異により最適化。SVGを設計し、視覚的に完成。

### 自動自己検査
11項目の検査を実施し、すべて合格するまで修正を繰り返します。

## トラブルシューティング

### プロンプトが見つからない
```bash
# forGPT5ブランチを確認
git fetch origin forGPT5
git ls-tree -r --name-only origin/forGPT5 | grep infographic
```

### 320px幅で横スクロールが発生
- プロンプト仕様のゲートB-G1が不合格
- スキルは自動的に修正を試みますが、入力情報が極端に長い場合は調整が必要

### SVGが見切れる
- プロンプト仕様の工程Cの検査項目に該当
- viewBox、ガター、マーカー長などが自動調整されます

## 技術詳細

### plan_docの構造

生成されるHTMLの`<head>`内には、以下のJSON形式の計画書が埋め込まれます（非表示）：

```json
{
  "quote_policy": "no_full_text",
  "version": "v9",
  "run": {...},
  "input_digest": "...",
  "assumptions": [...],
  "coverage": {
    "total_elements": 0,
    "visualized": 0,
    "summarized": 0,
    "footnoted": 0,
    "unmapped": 0
  },
  "phases": {...},
  "checks": [...],
  "metrics": {...},
  "risks": [...]
}
```

この計画書により、生成プロセスの透明性と追跡可能性が確保されます。

## 更新履歴

- 2025-10-23: 初版作成（動的プロンプト読み込み対応）

## ライセンス

このスキルは、プロンプト仕様（`infographic/infographic_forCLI.md`）に従って動作します。
